## Благотворительный сервис распределения пожертвований QRKot 

# Описание
Проект позволяет создавать целевые проекты для пожертвований и принимает пожертвования от пользователей. Сумма пожертвования распределяется по открытым проектам в порядке общей очереди. 

Технологический стек: FastAPI, SQLAlchemy, SQLite, PyDantic, Alembic, Uvicorn. 

# Установка

Склонировать проект: 
`git clone`
Развернуть вирутальное окружение: 
`python3 -m venv venv`
Установить зависимости:
`pip install -r requirements`
Применить миграции:
`alembic upgrade head`
Запустить проект:
`uvicorn app.main:app`

Для использования функции формирования отчета в Google Spreadsheets необходимо заполнить .env-файл реквизитами облачного сервиса Google.

API-документация доступна по эндпоинту `/docs`. 

# Примеры запросов: 

GET-запрос на эндпоинт `/donation/` от аутентифицированного пользователя возвращает список пожертвований этого пользователя. 
```
[
  {
    "full_amount": 0,
    "comment": "string",
    "id": 0,
    "create_date": "2019-08-24T14:15:22Z"
  }
]
```
Запрос на эндпоинт `/donation/` от суперюзера возвращает все существующие пожертвования: 
```
[
  {
    "full_amount": 0,
    "comment": "string",
    "id": 0,
    "create_date": "2019-08-24T14:15:22Z",
    "user_id": 0,
    "invested_amount": 0,
    "fully_invested": true,
    "close_date": "2019-08-24T14:15:22Z"
  }
]
```
POST-запрос на эндпоинт `/donation/` от аутентифицированного пользователя c одним обязательным параметром `full_amount` позволяет создать поджертвование. Тело запроса:
```
{
  "full_amount": 0,
  "comment": "string"
}
```

GET-запрос на эндпоинт `/charity_project/` от любого пользователя возвращает список всех благотворительных проектов, как открытых для пожертвований. так и уже закрытых.

```
[
  {
    "name": "string",
    "description": "string",
    "full_amount": 0,
    "id": 0,
    "invested_amount": 0,
    "fully_invested": true,
    "create_date": "2019-08-24T14:15:22Z",
    "close_date": "2019-08-24T14:15:22Z"
  }
]
```

Создание пожертвования: доступно только суперюзерам через POST-запрос на эндпоинт `/charity_project/`. Все поля в теле запроса обязательны: 
```
{
  "name": "string",
  "description": "string",
  "full_amount": 0
}
```

Редактирование и удаление проектов доступно по эндпоинту `/charity_project/{project_id}` только для суперюзеров. Удалить проект, в котором поле invested_amount превышает 0, невозможно, его можно только закрыть. 
Редактирование выполнено через PATCH-запрос, в в теле запроса может быть одно из трех полей: 
```
{
  "name": "string",
  "description": "string",
  "full_amount": 0
}
```
Закрытый проект нельзя редактировать; нельзя установить требуемую сумму (`full_amount`) меньше уже вложенной (`invested_amount`).

GET-запрос на эндпоинт `/google/` формирует отчет обо всех проинвестированных проектах в Google Spreadsheets. Доступно только суперпользователю. 

# Об авторе:
Павел Борисов, frailty.nine@gmail.com
Создано в рамках курса обучения «Бэкенд-разработка на Python +» в «Яндекс.Практикуме». 